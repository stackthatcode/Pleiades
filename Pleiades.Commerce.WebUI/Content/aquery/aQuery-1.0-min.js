/*! aQuery v1.0 code.google.com/p/aquery | license Daniel Henry MIT */
(function(){function b(d){this.all=function(g){if(typeof g!=="function"){throw"predicate must be a function"}for(var e=0,f=d.length;e<f;++e){if(!g(d[e])){return false}}return true};this.any=function(g){if(!g){return d.length>0}else{if(typeof g!=="function"){throw"predicate must be a function"}}for(var e=0,f=d.length;e<f;++e){if(g(d[e])){return true}}return false};this.average=function(e){if(typeof e!=="function"){e=function(f){return f}}return this.sum(e)/d.length};this.cast=function(e){if(e===Boolean||e==="boolean"){return this.select(function(f){return !!f})}else{if(e===Number||e==="number"){return this.select(function(f){return(+f)})}else{if(e===String||e==="string"){return this.select(function(f){return new String(f)})}}}throw"type not recognized"};this.contains=function(f,e){if(!e){e=function(g,h){return g===h}}else{if(typeof e!=="function"){throw"comparer must be a function"}}return this.any(function(g){return e(g,f)})};this.count=function(e){if(!e){return d.length}else{if(typeof e!=="function"){throw"predicate must be a function"}}var f=0;this.each(function(g){if(e(g)){++f}});return f};this.crossJoin=function(h,f){h=new b(h);if(!f){f=function(i,j){var k={};for(prop in i){if(Object.prototype.hasOwnProperty.call(i,prop)){k[prop]=i[prop]}}for(prop in j){if(Object.prototype.hasOwnProperty.call(j,prop)){k[prop]=j[prop]}}return k}}if(typeof f!=="function"){throw"joiner must be a function"}var e=[];var g=new b(e);this.each(function(i){h.each(function(j){e.push(f(i,j))})});return g};this.distinct=function(f){if(!f){f=function(h,i){return h===i}}if(typeof f!=="function"){throw"comparer must be a function"}var e=[];var g=new b(e);this.each(function(h){if(!g.any(function(i){return f(h,i)})){e.push(h)}});return g};this.each=function(g){if(typeof g!=="function"){throw"operation must be a function"}for(var e=0,f=d.length;e<f;e++){g(d[e])}return this};this.elementAt=function(e){e=(+e);if(e<0||e>=d.length){throw"index is less than 0 or greater than or equal to the number of elements in the array"}return d[e]};this.elementAtOrDefault=function(f,e){f=(+f);if(f<0||f>=d.length){return e}return d[f]};this.except=function(g,e){g=new b(g);if(!e){e=function(h,i){return h===i}}if(typeof e!=="function"){throw"comparer must be a function"}var f=[];this.each(function(h){if(!g.contains(h,e)){f.push(h)}});return new b(f)};this.first=function(h){if(!h){h=function(i){return true}}else{if(typeof h!=="function"){throw"predicate must be a function"}}for(var f=0,g=d.length;f<g;++f){var e=d[f];if(h(e)){return e}}throw"no elements satisfied the condition"};this.firstOrDefault=function(m,h){var o=null,n=null;for(var e=0,f=arguments.length;e<f;++e){var g=arguments[e];if(typeof g==="function"&&!o){o=g}else{if(g&&!n){n=g}}}if(!o){o=function(i){return true}}for(var k=0,l=d.length;k<l;++k){var j=d[k];if(o(j)){return j}}return n};this.groupBy=function(g,f){if(typeof g!=="function"){throw"keySelector must be a function"}if(!f){f=function(i,j){return i===j}}if(typeof f!=="function"){throw"comparer must be a function"}var e=[];var h=new b(e);this.each(function(i){var k=g(i);var j=h.firstOrDefault(function(l){return f(l.key,k)});if(j===null){j={key:k,values:[]};e.push(j)}j.values.push(i)});return h.select(function(i){return{key:i.key,values:new b(i.values)}})};this.indexOf=function(g){if(typeof g!=="function"){throw"predicate must be a function"}for(var e=0,f=d.length;e<f;++e){if(g(d[e])){return e}}return -1};this.intersect=function(g,e){g=new b(g);if(!e){e=function(h,i){return h===i}}if(typeof e!=="function"){throw"comparer must be a function"}var f=[];this.distinct(e).each(function(h){if(g.contains(h,e)){f.push(h)}});return new b(f)};this.join=function(i,g,f){i=new b(i);if(typeof g!=="function"){throw"predicate must be a function"}if(!f){f=function(j,k){var l={};for(prop in j){if(Object.prototype.hasOwnProperty.call(j,prop)){l[prop]=j[prop]}}for(prop in k){if(Object.prototype.hasOwnProperty.call(k,prop)){l[prop]=k[prop]}}return l}}if(typeof f!=="function"){throw"joiner must be a function"}var e=[];var h=new b(e);this.each(function(j){i.where(function(k){return g(j,k)}).each(function(k){e.push(f(j,k))})});return h};this.last=function(g){if(!g){g=function(h){return true}}else{if(typeof g!=="function"){throw"predicate must be a function"}}for(var f=d.length-1;f>=0;--f){var e=d[f];if(g(e)){return e}}throw"no elements satisfied the condition"};this.lastIndexOf=function(f){if(typeof f!=="function"){throw"predicate must be a function"}for(var e=d.length-1;e>=0;--e){if(f(d[e])){return e}}return -1};this.lastOrDefault=function(l,h){var n=null,m=null;for(var e=0,f=arguments.length;e<f;++e){var g=arguments[e];if(typeof g==="function"&&!n){n=g}else{if(g&&!m){m=g}}}if(!n){n=function(i){return true}}for(var k=d.length-1;k>=0;--k){var j=d[k];if(n(j)){return j}}return m};this.max=function(f){if(!f){f=function(g){return g}}if(typeof f!=="function"){throw"selector must be a function"}if(d.length===0){throw"array contains no elements"}var e=null;this.each(function(g){var h=f(g);if(h>e||!e){e=h}});return e};this.min=function(f){if(!f){f=function(g){return g}}if(typeof f!=="function"){throw"selector must be a function"}if(d.length===0){throw"array contains no elements"}var e=null;this.each(function(g){var h=f(g);if(h<e||!e){e=h}});return e};this.ofType=function(f){var e=[];if(typeof f==="string"){this.each(function(g){if(typeof g===f||(f==="boolean"&&g instanceof Boolean)||(f==="null"&&g===null)||(f==="object"&&g instanceof Object)||(f==="number"&&g instanceof Number)||(f==="string"&&g instanceof String)||(f==="undefined"&&g===undefined)){e.push(g)}})}else{this.each(function(g){if((f!==undefined&&f!==null&&g instanceof f)||(f===Boolean&&typeof g==="boolean")||(f===null&&g===null)||(f===Object&&typeof g==="object")||(f===Number&&typeof g==="number")||(f===String&&typeof g==="string")||(f===undefined&&g===undefined)){e.push(g)}})}return new b(e)};this.orderBy=function(e){if(!e){e=function(g){return g}}if(typeof e!=="function"){throw"keySelector must be a function"}var f=d.slice();f.sort(function(g,i){var h=e(g);var j=e(i);if(h<j){return -1}else{if(h>j){return 1}}return 0});return new b(f)};this.orderByDescending=function(e){if(!e){e=function(g){return g}}if(typeof e!=="function"){throw"keySelector must be a function"}var f=d.slice();f.sort(function(g,i){var h=e(g);var j=e(i);if(h<j){return 1}else{if(h>j){return -1}}return 0});return new b(f)};this.outerJoin=function(i,g,f){i=new b(i);if(typeof g!=="function"){throw"predicate must be a function"}if(!f){f=function(k,l){var m={};for(prop in k){if(Object.prototype.hasOwnProperty.call(k,prop)){m[prop]=k[prop]}}for(prop in l){if(Object.prototype.hasOwnProperty.call(l,prop)){m[prop]=l[prop]}}return m}}if(typeof f!=="function"){throw"joiner must be a function"}var e=[];var h=new b(e);this.each(function(k){i.where(function(l){return g(k,l)}).each(function(l){e.push(f(k,l))})});var j=this;this.where(function(k){return !i.any(function(l){return g(k,l)})}).each(function(k){e.push(f(k,null))});i.where(function(k){return !j.any(function(l){return g(l,k)})}).each(function(k){e.push(f(null,k))});return h};this.select=function(f){if(typeof f!=="function"){throw"selector must be a function"}var e=[];this.each(function(g){e.push(f(g))});return new b(e)};this.sequenceEqual=function(f,e){f=new b(f);if(!e){e=function(h,i){return h===i}}if(typeof e!=="function"){throw"comparer must be a function"}var g=this;if(d.length!==f.count()){return false}else{if(this.any(function(h){return !f.contains(h)})){return false}else{if(f.any(function(h){return !g.contains(h)})){return false}}}return true};this.single=function(g){if(!g){g=function(h){return true}}else{if(typeof g!=="function"){throw"predicate must be a function"}}var e=null,f=0;this.each(function(h){if(g(h)){e=h;++f}});if(f==0){throw"no elements satisfied the condition"}else{if(f>1){throw"more than one element satisfied the condition"}}return e};this.singleOrDefault=function(k,h){var m=null,l=null;for(var e=0,f=arguments.length;e<f;++e){var g=arguments[e];if(typeof g==="function"&&!m){m=g}else{if(g&&!l){l=g}}}if(!m){m=function(n){return true}}var i=null,j=0;this.each(function(n){if(m(n)){i=n;++j}});if(j==0){return l}else{if(j>1){throw"more than one element satisfied the condition"}}return i};this.skip=function(e){var h=[];for(var f=(+e),g=d.length;f<g;++f){h.push(d[f])}return new b(h)};this.skipWhile=function(g){if(typeof g!=="function"){throw"predicate must be a function"}var h=[];var e=0,f=d.length;while(e<f){if(!g(d[e])){break}++e}while(e<f){h.push(d[e]);++e}return new b(h)};this.sum=function(f){if(!f){selection=function(g){return g}}else{if(typeof f!=="function"){throw"selector must be a function"}}var e=0;this.each(function(g){e+=f(g)});return e};this.take=function(e){var h=[];for(var f=0,g=e<d.length?e:d.length;f<g;++f){h.push(d[f])}return new b(h)};this.takeWhile=function(h){if(typeof h!=="function"){throw"predicate must be a function"}var j=[];for(var f=0,g=d.length;f<g;++f){var e=d[f];if(!h(e)){break}j.push(e)}return new b(j)};this.toArray=function(){return d.slice()};this.toString=function(){return d.toString()};this.union=function(h,f){h=new b(h);if(!f){f=function(i,j){return i===j}}if(typeof f!=="function"){throw"comparer must be a function"}var e=this.distinct().toArray();var g=new b(e);h.each(function(i){if(!g.contains(i)){e.push(i)}});return g};this.where=function(e){if(typeof e!=="function"){throw"predicate must be a function"}var f=[];this.each(function(g){if(e(g)){f.push(g)}});return new b(f)}}var a=function c(d){if(d instanceof Array){return new b(d)}else{if(d instanceof b){return d}else{if(d.toArray){c(d.toArray())}else{return new b(Array.prototype.slice.call(d))}}}};a.isQuery=function(d){return d instanceof b};a.range=function(h,d){var g=[];for(var e=h,f=h+d;e<=f;++e){g.push(e)}return new b(g)};if(!Array.prototype.toQuery){Array.prototype.toQuery=function(){return new b(this)}}if(typeof module!=="undefined"&&module.exports){module.exports=a}else{if(typeof window!=="undefined"){window.AQ=a}}}());